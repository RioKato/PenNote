# Precautionary
----

# General
1. タイムスタンプに気をつけること
	* ファイルのタイムスタンプ
	* WebページのCopyRight
	* net user administratorのパスワード最終設定時間
	* uname -a のOSのタイムスタンプ
1. 珍しいもの/見覚えのないもの/違和感のあるものに気をつけること
	* 珍しいファイル名
	* 珍しいエラー出方 / ファジング出力
	* 301コードのwebページのサイズが一致しない、など
1. 脆弱性ではなく、予め備わっている正規の機能の悪用を最初に検討すること
	* Shell実行機能
	* Password Reset / Admin権限付与機能
	* PHPテンプレート編集機能
	* Package/ Pluginアップロード機能
1. 異常な入力値を試行する前に、正常な入力値をモディファイしたものを試行すること
    * 正常な入力値がファイル名の場合、拡張子を削ったものを試行
    * 入力値をすべて削ったもの（空文字）を試行
1. URLに注目する/URLの意味解釈を行うこと
	* URLの中の数字
	* 1y、1m、1dなどのパラメータを思わせるキーワード
1. suid/sgid/cron/sudoなど特権で実行されるプログラムが見覚えのあるものであっても、既知の脆弱性に気をつけること 
    * screenの脆弱性
    * sudoの脆弱性
1. rootで動作しているデーモンが、（デーモンのユーザですらない）別ユーザで動作するプロセスを生成する可能性に気をつけること
    * postfix
    * systemd
    * cron

## PWN
* 処理の流れと、オブジェクトの所有/ライフタイムの両側面から脆弱性を分析

1. 不正なパスが成立する
   * 条件分岐や、関数ポインタ他
   * ループ内で２回以上、同一の関数が呼ばれるケースも想定
1. 入力値の検証に誤りがある
   * Integer Overflow
   * 関数の引数のoffsetやlengthが正常に検証されているかどうか、チェック
1. 入力値の検証がそもそも、なされていない
   * 見落としやすい
   1. 関数の引数に本来、あるべきパラメータがないパターン
      * 例えばXXXCopy関数の引数にバッファの長さを示すパラメータがない
   2. パラメータは存在するが、チェックされていないパターン
      * 例えばXXXCopy関数の引数にバッファの長さを示すパラメータが存在するが、そのパラメータがチェックされずにコピー関数などに渡されている
1. 同一のオブジェクトを指すポインタが同時に二箇所以上に存在する
   * 複数の所有
   * ある関数の引数の第一引数がバッファのポインタ、第２引数も前述のバッファのポインタであるケース
   * レースコンディション
1. オブジェクトのファイナライズが正常に行われない
   * オブジェクトが消滅したのにオブジェクトのポインタが生存したままである